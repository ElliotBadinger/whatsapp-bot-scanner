# Core
NODE_ENV=development

# Redis
REDIS_URL=redis://redis:6379/0

# Postgres
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=wbscanner
POSTGRES_USER=wbscanner
POSTGRES_PASSWORD=wbscanner

# Queues
SCAN_REQUEST_QUEUE=scan-request
SCAN_VERDICT_QUEUE=scan-verdict
SCAN_URLSCAN_QUEUE=scan-urlscan

# Orchestrator
SCAN_CONCURRENCY=10
URL_EXPANSION_MAX_REDIRECTS=5
URL_EXPANSION_TIMEOUT_MS=5000
URL_MAX_CONTENT_LENGTH=1048576
CACHE_TTL_BENIGN_SECONDS=86400
CACHE_TTL_SUSPICIOUS_SECONDS=3600
CACHE_TTL_MALICIOUS_SECONDS=900

# VirusTotal
VT_API_KEY=
VT_REQUEST_TIMEOUT_MS=8000
# Token bucket limiter for the community tier. Raise after purchasing a higher quota.
VT_REQUESTS_PER_MINUTE=4
# Random delay (milliseconds) injected ahead of each request to avoid synchronized bursts.
VT_REQUEST_JITTER_MS=500

# Google Safe Browsing
GSB_API_KEY=
GSB_REQUEST_TIMEOUT_MS=5000
GSB_FALLBACK_LATENCY_MS=500

# RDAP / WHOIS
RDAP_TIMEOUT_MS=5000
WHOISXML_ENABLE=true
WHOISXML_API_KEY=
WHOISXML_TIMEOUT_MS=5000
WHOISXML_MONTHLY_QUOTA=500
WHOISXML_QUOTA_ALERT_THRESHOLD=100

# URLhaus
URLHAUS_ENABLED=true
URLHAUS_TIMEOUT_MS=5000

# Phishtank
PHISHTANK_ENABLED=true
PHISHTANK_APP_KEY=
PHISHTANK_USER_AGENT=wbscanner-bot/1.0
PHISHTANK_TIMEOUT_MS=5000

# urlscan.io
URLSCAN_ENABLED=true
URLSCAN_API_KEY=
URLSCAN_BASE_URL=https://urlscan.io
URLSCAN_VISIBILITY=private
URLSCAN_TAGS=wbscanner
URLSCAN_CALLBACK_URL=
URLSCAN_CALLBACK_SECRET=
URLSCAN_SUBMIT_TIMEOUT_MS=10000
URLSCAN_RESULT_TIMEOUT_MS=30000
URLSCAN_UUID_TTL_SECONDS=86400
URLSCAN_RESULT_TTL_SECONDS=86400
URLSCAN_CONCURRENCY=2

# Shortener expansion
UNSHORTEN_ENDPOINT=https://unshorten.me/json/
UNSHORTEN_RETRIES=1
SHORTENER_CACHE_TTL_SECONDS=86400

# LLM (optional)
LLM_ENABLED=false
OPENAI_API_KEY=

# WA Client
WA_HEADLESS=true
WA_QR_TERMINAL=true
WA_CONSENT_ON_JOIN=true
WA_QUIET_HOURS=22-07
WA_PER_GROUP_REPLY_COOLDOWN_SECONDS=60
# Global token bucket: messages per hour across all groups
WA_GLOBAL_REPLY_RATE_PER_HOUR=1000
# Redis key prefix for the global token bucket state
WA_GLOBAL_TOKEN_BUCKET_KEY=wa_global_token_bucket
# Per-group hourly limit for verdict replies
WA_PER_GROUP_HOURLY_LIMIT=60

# Control Plane (API token is required; generate a strong random string)
CONTROL_PLANE_PORT=8080
CONTROL_PLANE_API_TOKEN=change-me
CONTROL_PLANE_ENABLE_UI=true
CONTROL_PLANE_BASE=http://control-plane:8080

# Reverse Proxy
REVERSE_PROXY_PORT=8088
REVERSE_PROXY_ALLOWED_IPS=0.0.0.0/0

# Observability
METRICS_PORT=9090
PROMETHEUS_SCRAPE_INTERVAL=5s
